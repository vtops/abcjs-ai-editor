# 修复 Cloudflare Pages 404 问题

## 问题描述

部署成功但访问页面显示 404，这是因为 Cloudflare Pages 需要配置 SPA 路由重定向。

**重要**：Cloudflare Pages **不支持** `_redirects` 文件（这是 Netlify 的格式）。需要使用 Cloudflare Dashboard 配置重定向规则。

## 解决方案

### ✅ 推荐方案：在 Cloudflare Dashboard 配置重定向

1. **登录 Cloudflare Dashboard**
   - 进入你的 Pages 项目

2. **配置重定向规则**
   - 进入 **Settings** → **Functions** → **Redirects**
   - 点击 **Add a redirect rule**
   - 配置如下：
     - **Source**: `/*`
     - **Destination**: `/index.html`
     - **Status code**: `200`
   - 点击 **Save**

3. **重新部署**
   - 在 **Deployments** 标签页
   - 找到最新的部署
   - 点击 **Retry deployment**

### 备选方案：使用 Functions（高级）

如果需要更复杂的路由处理，可以创建 `functions/_middleware.ts` 文件来处理路由。

## 验证修复

部署完成后，访问以下 URL 应该都能正常加载：
- `https://your-project.pages.dev/` （根路径）
- `https://your-project.pages.dev/any-route` （任意路由）

如果仍然 404，请检查：
1. 浏览器开发者工具 → Network 标签，查看具体哪个资源返回 404
2. Cloudflare Dashboard → 部署日志，确认所有文件都已上传
3. 确认 `build/client` 目录包含 `index.html` 和 `_redirects` 文件

## 常见问题

### Q: 为什么 Cloudflare Pages 不支持 `_redirects` 文件？

A: `_redirects` 是 Netlify 的格式。Cloudflare Pages 使用 Dashboard 配置或 Functions 来处理重定向。

### Q: 为什么只上传了 8 个文件？

A: Cloudflare Pages 可能只统计了主要资源文件。检查部署日志中的 "Uploading..." 部分，应该包含所有文件。

### Q: 如何确认重定向规则已生效？

A: 在 Cloudflare Dashboard → Settings → Functions → Redirects 中查看已配置的规则。访问任意路由（如 `/test`）应该能正常加载页面。
